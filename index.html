<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Pi Platba Test</title>
  <script src="https://sdk.minepi.com/pi-sdk.js"></script>
</head>
<body>
  <h2>Pi Platba Test</h2>
  <button id="login">🔐 Přihlásit</button>
  <button id="pay">💸 Platit 1π</button>

  <script>
    Pi.init({ version: "2.0" });

    document.getElementById("login").onclick = function () {
      Pi.authenticate(["payments"], (p) => {
        console.log("Nalezena neúplná platba", p);
      }).then((auth) => {
        alert("✅ Přihlášen jako: " + auth.user.username);
      }).catch((err) => {
        alert("❌ Chyba přihlášení: " + err.message);
      });
    };

    document.getElementById("pay").onclick = function () {
      Pi.createPayment({
        amount: 1,
        memo: "Test platba pro Pi",
        metadata: { test: true }
      }, {
        onReadyForServerApproval(paymentId) {
          console.log("💡 Ready for approval:", paymentId);
        },
        onReadyForServerCompletion(paymentId, txid) {
          console.log("✅ Hotovo:", paymentId, txid);
        },
        onCancel(paymentId) {
          alert("❌ Zrušeno: " + paymentId);
        },
        onError(error) {
          alert("❌ Error: " + error.message);
        }
      });
    };
  </script>
</body>
</html>
